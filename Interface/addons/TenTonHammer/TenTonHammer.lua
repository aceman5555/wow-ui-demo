local vsn="4.10.02"; local vwcl = "219"; local qaa=true; TTHE={}; local qab={}; local qac={}; local qad={}; local qae={}; local qaf={}; local qag={}; local qah={}; local qai={}; local qaj={}; local qak={}; local qal={}; local qam={}; local qan={}; local qao={}; local qap={}; local qaq={}; local qei={}; local qar={}; local qas=nil; local qat=nil; local qau=nil; local qav=nil; local qaw=nil; local qax=nil; local qay=nil; local qaz=nil; local qba=nil; local qas0=nil; local qas1=nil; local qbe=""; local qbf=""; local qbg=""; local qbh=""; local qbi=""; local qbj=""; local qbk=0; local qbl=0; local qbm="en"; local qbn={}; local frame=_G.CreateFrame("Frame","TTHCFrame"); local unko=_G.UNKNOWNOBJECT:lower(); local unkb=_G.UKNOWNBEING:lower(); local unk=_G.UNKNOWN:lower(); local qbo=""; local qbp=0; local qbq=true; local qbr=nil; local qbs=nil; local qbt=nil; local qbu=nil; local qbv=nil; local qbw=5; local llid=0; local qer=nil; local qerTarget=nil; local qex=nil; local zae=nil; frame:RegisterEvent("ADDON_LOADED"); frame:RegisterEvent("TRADE_SKILL_SHOW"); frame:RegisterEvent("UPDATE_FACTION"); frame:RegisterEvent("GLYPH_UPDATED"); frame:RegisterEvent("LOOT_OPENED"); frame:RegisterEvent("LOOT_CLOSED"); frame:RegisterEvent("ACHIEVEMENT_EARNED"); frame:RegisterEvent("AUCTION_HOUSE_SHOW"); frame:RegisterEvent("AUCTION_ITEM_LIST_UPDATE"); frame:RegisterEvent("BANKFRAME_OPENED"); frame:RegisterEvent("BATTLEFIELDS_SHOW"); frame:RegisterEvent("CHAT_MSG_COMBAT_FACTION_CHANGE"); frame:RegisterEvent("CHAT_MSG_COMBAT_HONOR_GAIN"); frame:RegisterEvent("CHAT_MSG_MONSTER_EMOTE"); frame:RegisterEvent("CHAT_MSG_MONSTER_SAY"); frame:RegisterEvent("CHAT_MSG_MONSTER_WHISPER"); frame:RegisterEvent("CHAT_MSG_MONSTER_YELL"); frame:RegisterEvent("COMBAT_LOG_EVENT_UNFILTERED"); frame:RegisterEvent("CONFIRM_BINDER"); frame:RegisterEvent("CONFIRM_PET_UNLEARN"); frame:RegisterEvent("CONFIRM_TALENT_WIPE"); frame:RegisterEvent("GUILD_REGISTRAR_SHOW"); frame:RegisterEvent("MERCHANT_SHOW"); frame:RegisterEvent("MERCHANT_UPDATE"); frame:RegisterEvent("OPEN_TABARD_FRAME"); frame:RegisterEvent("PET_BAR_UPDATE"); frame:RegisterEvent("PET_STABLE_SHOW"); frame:RegisterEvent("PLAYER_TARGET_CHANGED"); frame:RegisterEvent("TAXIMAP_OPENED"); frame:RegisterEvent("TRAINER_SHOW"); frame:RegisterEvent("UNIT_COMBAT"); frame:RegisterEvent("MAIL_SHOW"); frame:RegisterEvent("ITEM_TEXT_BEGIN"); frame:RegisterEvent("ITEM_TEXT_READY"); frame:RegisterEvent("PLAYER_LOGIN"); frame:RegisterEvent("PLAYER_LOGOUT"); frame:RegisterEvent("COMBAT_TEXT_UPDATE"); frame:RegisterEvent("QUEST_ACCEPTED"); frame:RegisterEvent("QUEST_COMPLETE"); frame:RegisterEvent("QUEST_DETAIL") frame:RegisterEvent("QUEST_PROGRESS") frame:RegisterEvent("QUEST_LOG_UPDATE"); frame:RegisterEvent("QUEST_QUERY_COMPLETE"); frame:RegisterEvent("UNIT_SPELLCAST_FAILED"); frame:RegisterEvent("UNIT_SPELLCAST_FAILED_QUIET"); frame:RegisterEvent("UNIT_SPELLCAST_INTERRUPTED"); frame:RegisterEvent("UNIT_SPELLCAST_SENT"); frame:RegisterEvent("UNIT_SPELLCAST_SUCCEEDED"); frame:RegisterEvent("PLAYER_ENTERING_WORLD"); frame:RegisterEvent("ZONE_CHANGED"); frame:RegisterEvent("ZONE_CHANGED_NEW_AREA"); _G.CreateFrame("GameTooltip","qdo"); qdo:SetOwner( WorldFrame, "ANCHOR_NONE" ); qdo:AddFontStrings(qdo:CreateFontString( "$parentTextLeft1",nil,"GameTooltipText"),qdo:CreateFontString("$parentTextRight1",nil,"GameTooltipText")); local qbx={ ["INVTYPE_AMMO"]=24, ["INVTYPE_HEAD"]=1, ["INVTYPE_NECK"]=2, ["INVTYPE_SHOULDER"]=3, ["INVTYPE_BODY"]=5, ["INVTYPE_CHEST"]=4, ["INVTYPE_ROBE"]=20, ["INVTYPE_WAIST"]=6, ["INVTYPE_LEGS"]=7, ["INVTYPE_FEET"]=8, ["INVTYPE_WRIST"]=9, ["INVTYPE_HAND"]=10, ["INVTYPE_FINGER"]=11, ["INVTYPE_TRINKET"]=12, ["INVTYPE_CLOAK"]=16, ["INVTYPE_WEAPON"]=13, ["INVTYPE_SHIELD"]=14, ["INVTYPE_2HWEAPON"]=17, ["INVTYPE_WEAPONMAINHAND"]=21, ["INVTYPE_WEAPONOFFHAND"]=22, ["INVTYPE_HOLDABLE"]=23, ["INVTYPE_RANGED"]=26, ["INVTYPE_THROWN"]=25, ["INVTYPE_RANGEDRIGHT"]=27, ["INVTYPE_RELIC"]=28, ["INVTYPE_TABARD"]=19, ["INVTYPE_BAG"]=18, ["INVTYPE_QUIVER"]=0, ["INVTYPE_NONE"]=0, } qby={ ["Armor"]=4, ["Consumable"]=0, ["Container"]=1, ["Gem"]=3, ["Glyph"]=16, ["Key"]=13, ["Miscellaneous"]=15, ["Money"]=10, ["Reagent"]=5, ["Recipe"]=9, ["Projectile"]=6, ["Quest"]=12, ["Quiver"]=11, ["Trade Goods"]=7, ["Weapon"]=2, } qbz={ [0]={ ["Consumable"]=0, ["Food & Drink"]=5, ["Potion"]=1, ["Elixir"]=2, ["Flask"]=3, ["Bandage"]=7, ["Item Enhancement"]=6, ["Scroll"]=4, ["Other"]=8, }, [1]={ ["Soul Bag"]=1, ["Herb Bag"]=2, ["Enchanting Bag"]=3, ["Engineering Bag"]=4, ["Gem Bag"]=5, ["Mining Bag"]=6, ["Leatherworking Bag"]=7, ["Inscription Bag"]=8, ["Tackle Box"]=9, ["Bag"]=0, }, [2]={ ["One-Handed Axes"]=0, ["Two-Handed Axes"]=1, ["Bows"]=2, ["Guns"]=3, ["One-Handed Maces"]=4, ["Two-Handed Maces"]=5, ["Polearms"]=6, ["One-Handed Swords"]=7, ["Two-Handed Swords"]=8, ["Obsolete"]=9, ["Staves"]=10, ["Exotic"]=11, ["Fist Weapons"]=13, ["Miscellaneous"]=14, ["Daggers"]=15, ["Thrown"]=16, ["Spears"]=17, ["Crossbows"]=18, ["Wands"]=19, ["Fishing Poles"]=20, }, [3]={ ["Red"]=0, ["Blue"]=1, ["Yellow"]=2, ["Purple"]=3, ["Green"]=4, ["Orange"]=5, ["Meta"]=6, ["Simple"]=7, ["Prismatic"]=8, ["Hydraulic"]=9, ["Cogwheel"]=10, }, [4]={ ["Miscellaneous"]=0, ["Cloth"]=1, ["Leather"]=2, ["Mail"]=3, ["Plate"]=4, ["Shields"]=6, ["Librams"]=7, ["Libram"]=7, ["Idol"]=8, ["Totem"]=9, ["Totems"]=9, ["Sigil"]=10, ["Relic"]=11, }, [5]={ ["Reagent"]=0, }, [6]={ ["Arrow"]=2, ["Bullet"]=3, }, [7]={ ["Trade Goods"]=0, ["Parts"]=1, ["Explosives"]=2, ["Devices"]=3, ["Cloth"]=5, ["Jewelcrafting"]=4, ["Leather"]=6, ["Metal & Stone"]=7, ["Meat"]=8, ["Herb"]=9, ["Elemental"]=10, ["Other"]=11, ["Enchanting"]=12, ["Materials"]=13, ["Item Enchantment"]=14, ["Weapon Enchantment"]=15, }, [9]={ ["Book"]=0, ["Leatherworking"]=1, ["Tailoring"]=2, ["Engineering"]=3, ["Blacksmithing"]=4, ["Cooking"]=5, ["Alchemy"]=6, ["First Aid"]=7, ["Enchanting"]=8, ["Fishing"]=9, ["Jewelcrafting"]=10, ["Inscription"]=11, }, [10]={ ["Money(OBSOLETE)"]=0, }, [11]={ ["Quiver"]=2, ["Ammo Pouch"]=3, }, [12]={ ["Quest"]=0, }, [13]={ ["Key"]=0, ["Lockpick"]=1, }, [14]={ ["Permanent"]=0, }, [15]={ ["Junk"]=0, ["Reagent"]=1, ["Pet"]=2, ["Holiday"]=3, ["Other"]=4, ["Mount"]=5, }, [16]={ ["Warrior"]=1, ["Paladin"]=2, ["Hunter"]=3, ["Rogue"]=4, ["Priest"]=5, ["Death Knight"]=6, ["Shaman"]=7, ["Mage"]=8, ["Warlock"]=9, ["Druid"]=11, }, } local qca={ ["WARRIOR"]=1, ["PALADIN"]=2, ["HUNTER"]=3, ["ROGUE"]=4, ["PRIEST"]=5, ["DEATHKNIGHT"]=6, ["SHAMAN"]=7, ["MAGE"]=8, ["WARLOCK"]=9, ["DRUID"]=10 } local qcaIFICATION={ ["normal"]=0, ["elite"]=1, ["rareelite"]=2, ["worldboss"]=3, ["rare"]=4 } local qcd={ ["Beast"]=1, ["Dragonkin"]=2, ["Demon"]=3, ["Elemental"]=4, ["Giant"]=5, ["Undead"]=6, ["Humanoid"]=7, ["Critter"]=8, ["Mechanical"]=9, ["Not specified"]=10, ["Totem"]=11, ["Non-Combat Pet"]=12, ["Gas Cloud"]=13 } local qcc={ ["Wolf"]=1, ["Cat"]=2, ["Spider"]=3, ["Bear"]=4, ["Boar"]=5, ["Crocolisk"]=6, ["Carrion Bird"]=7, ["Crab"]=8, ["Gorilla"]=9, ["Raptor"]=11, ["Tallstrider"]=12, ["Felhunter"]=15, ["Voidwalker"]=16, ["Succubus"]=17, ["Doomguard"]=19, ["Scorpid"]=20, ["Turtle"]=21, ["Imp"]=23, ["Bat"]=24, ["Hyena"]=25, ["Bird of Prey"]=26, ["Wind Serpent"]=27, ["Remote Control"]=28, ["Felguard"]=29, ["Dragonhawk"]=30, ["Ravager"]=31, ["Warp Stalker"]=32, ["Sporebat"]=33, ["Nether Ray"]=34, ["Serpent"]=35, ["Moth"]=37, ["Chimaera"]=38, ["Devilsaur"]=39, ["Ghoul"]=40, ["Silithid"]=41, ["Worm"]=42, ["Rhino"]=43, ["Wasp"]=44, ["Core Hound"]=45, ["Spirit Beast"]=46 } local qce={ ["ITEM_MOD_AGILITY_SHORT"]="290", ["ITEM_MOD_ARMOR_PENETRATION_RATING_SHORT"]="295", ["ITEM_MOD_ATTACK_POWER_SHORT"]="296", ["ITEM_MOD_BLOCK_RATING_SHORT"]="297", ["ITEM_MOD_BLOCK_VALUE_SHORT"]="298", ["ITEM_MOD_CRIT_MELEE_RATING_SHORT"]="299", ["ITEM_MOD_CRIT_RANGED_RATING_SHORT"]="300", ["ITEM_MOD_CRIT_RATING_SHORT"]="301", ["ITEM_MOD_CRIT_SPELL_RATING_SHORT"]="302", ["ITEM_MOD_CRIT_TAKEN_MELEE_RATING_SHORT"]="303", ["ITEM_MOD_CRIT_TAKEN_RANGED_RATING_SHORT"]="304", ["ITEM_MOD_CRIT_TAKEN_RATING_SHORT"]="305", ["ITEM_MOD_CRIT_TAKEN_SPELL_RATING_SHORT"]="306", ["ITEM_MOD_DAMAGE_PER_SECOND_SHORT"]="307", ["ITEM_MOD_DEFENSE_SKILL_RATING_SHORT"]="308", ["ITEM_MOD_DODGE_RATING_SHORT"]="309", ["ITEM_MOD_EXPERTISE_RATING_SHORT"]="310", ["ITEM_MOD_FERAL_ATTACK_POWER_SHORT"]="311", ["ITEM_MOD_HASTE_MELEE_RATING_SHORT"]="312", ["ITEM_MOD_HASTE_RANGED_RATING_SHORT"]="313", ["ITEM_MOD_HASTE_RATING_SHORT"]="314", ["ITEM_MOD_HASTE_SPELL_RATING_SHORT"]="315", ["ITEM_MOD_HEALTH_REGENERATION_SHORT"]="316", ["ITEM_MOD_HEALTH_REGEN_SHORT"]="317", ["ITEM_MOD_HEALTH_SHORT"]="318", ["ITEM_MOD_HIT_MELEE_RATING_SHORT"]="319", ["ITEM_MOD_HIT_RANGED_RATING_SHORT"]="320", ["ITEM_MOD_HIT_RATING_SHORT"]="321", ["ITEM_MOD_HIT_SPELL_RATING_SHORT"]="322", ["ITEM_MOD_HIT_TAKEN_MELEE_RATING_SHORT"]="323", ["ITEM_MOD_HIT_TAKEN_RANGED_RATING_SHORT"]="324", ["ITEM_MOD_HIT_TAKEN_RATING_SHORT"]="325", ["ITEM_MOD_HIT_TAKEN_SPELL_RATING_SHORT"]="326", ["ITEM_MOD_INTELLECT_SHORT"]="291", ["ITEM_MOD_MANA_REGENERATION_SHORT"]="327", ["ITEM_MOD_MANA_SHORT"]="61", ["ITEM_MOD_MASTERY_RATING_SHORT"]="328", ["ITEM_MOD_MELEE_ATTACK_POWER_SHORT"]="329", ["ITEM_MOD_PARRY_RATING_SHORT"]="330", ["ITEM_MOD_POWER_REGEN0_SHORT"]="331", ["ITEM_MOD_POWER_REGEN1_SHORT"]="332", ["ITEM_MOD_POWER_REGEN2_SHORT"]="333", ["ITEM_MOD_POWER_REGEN4_SHORT"]="334", ["ITEM_MOD_POWER_REGEN5_SHORT"]="335", ["ITEM_MOD_POWER_REGEN6_SHORT"]="336", ["ITEM_MOD_POWER_REGEN3_SHORT"]="337", ["ITEM_MOD_RANGED_ATTACK_POWER_SHORT"]="338", ["ITEM_MOD_RESILIENCE_RATING_SHORT"]="126", ["ITEM_MOD_SPELL_DAMAGE_DONE_SHORT"]="339", ["ITEM_MOD_SPELL_HEALING_DONE_SHORT"]="340", ["ITEM_MOD_SPELL_PENETRATION_SHORT"]="341", ["ITEM_MOD_SPELL_POWER_SHORT"]="342", ["ITEM_MOD_SPIRIT_SHORT"]="292", ["ITEM_MOD_STAMINA_SHORT"]="294", ["ITEM_MOD_STRENGTH_SHORT"]="293", } local qcf={ ["Abyssal Depths"]=5145, ["Abyssal Maw"]=4738, ["Ahn'kahet: The Old Kingdom"]=4494, ["Ahn'Qiraj: The Fallen Kingdom"]=5695, ["Auchindoun: Auchenai Crypts"]=3790, ["Alliance Mercenary Ship to Vashj'ir"]=5348, ["Alterac Mountains"]=36, ["Alterac Valley"]=2597, ["Arathi Basin"]=3358, ["Arathi Highlands"]=45, ["Ashenvale"]=331, ["Auchindoun: Auchenai Crypts"]=3790, ["Auchindoun: Mana-Tombs"]=3792, ["Auchindoun: Sethekk Halls"]=3791, ["Auchindoun: Shadow Labyrinth"]=3789, ["Azjol-Nerub: Ahn'kahet: The Old Kingdom"]=4494, ["Azjol-Nerub: Azjol-Nerub"]=3477, ["Azshara"]=16, ["Azuremyst Isle"]=3524, ["Badlands"]=3, ["Baradan Hold"]=5600, ["Bastion of Twilight"]=5334, ["Black Temple"]=3959, ["Blackfathom Deeps"]=719, ["Blackrock Caverns"]=4926, ["Blackrock Depths"]=1584, ["Blackrock Mountain"]=25, ["Blackrock Mountain: Blackwing Descent"]=5094, ["Blackrock Spire"]=1583, ["Blackwing Descent"]=5094, ["Blackwing Lair"]=2677, ["Blade's Edge Mountains"]=3522, ["Blasted Lands"]=4, ["Bloodmyst Isle"]=3525, ["Borean Tundra"]=3537, ["Burning Steppes"]=46, ["Caverns of Time: Hyjal Summit"]=3606, ["Caverns of Time: Old Hillsbrad Foothills"]=2367, ["Caverns of Time: The Black Morass"]=2366, ["Caverns of Time: The Culling of Stratholme"]=4100, ["Coilfang Reservoir: Serpentshrine Cavern"]=3607, ["Coilfang Reservoir: The Slave Pens"]=3717, ["Coilfang Reservoir: The Steamvault"]=3715, ["Coilfang Reservoir: The Underbog"]=3716, ["Crystalsong Forest"]=2817, ["Dalaran"]=4395, ["Dalaran Sewers"]=4378, ["Darkshore"]=148, ["Darnassus"]=1657, ["Deadwind Pass"]=41, ["Deepholm"]=5042, ["Deeprun Tram"]=2257, ["Desolace"]=405, ["Dire Maul"]=2557, ["Dragonblight"]=65, ["Dragon Soul"]=5892, ["Drak'Tharon Keep"]=4196, ["Dun Morogh"]=1, ["Durotar"]=14, ["Duskwood"]=10, ["Dustwallow Marsh"]=15, ["Eastern Plaguelands"]=139, ["Elwynn Forest"]=12, ["End Time"]=5789, ["Eversong Woods"]=3430, ["Eye of the Storm"]=3820, ["Falconwing Square"]=3430, ["Felwood"]=361, ["Feralas"]=357, ["Firelands"]=5723, ["Force Interior"]=4602, ["Ghostlands"]=3433, ["Gilneas"]=4714, ["Gilneas City"]=4755, ["Gnomeregan"]=133, ["Grim Batol"]=4950, ["Grizzly Hills"]=394, ["Gruul's Lair"]=3618, ["Gundrak"]=4375, ["Halls of Lightning"]=4272, ["Halls of Origination"]=4945, ["Halls of Reflection"]=4820, ["Hellfire Citadel: Hellfire Ramparts"]=3562, ["Hellfire Citadel: Magtheridon's Lair"]=3836, ["Hellfire Citadel: The Blood Furnace"]=3713, ["Hellfire Citadel: The Shattered Halls"]=3714, ["Hellfire Peninsula"]=3483, ["Hillsbrad Foothills"]=267, ["Hour of Twilight"]=5844, ["Howling Fjord"]=495, ["Hrothgar's Landing"]=4742, ["Icecrown"]=210, ["Icecrown Citadel"]=4812, ["Ironforge"]=1537, ["Isle of Conquest"]=4710, ["Isle of Quel'Danas"]=4080, ["Karazhan"]=2562, ["Kezan"]=4737, ["Loch Modan"]=38, ["Lost City of Tol'vir"]=5396, ["Magisters' Terrace"]=4095, ["Maraudon"]=2100, ["Miwana's Longhouse"]=1637, ["Molten Core"]=2717, ["Molten Front"]=5733, ["Moonglade"]=493, ["Mount Hyjal"]=616, ["Nagrand"]=3518, ["Naxxramas"]=3456, ["Netherstorm"]=3523, ["Northern Barrens"]=17, ["Northern Stranglethorn"]=33, ["Nightmare Scar"]=4887, ["Onyxia's Lair"]=2159, ["Orgrimmar"]=1637, ["Pit of Saron"]=4813, ["Putricide's Laboratory of Alchemical Horrors and Fun"]=4894, ["Ragefire Chasm"]=2437, ["Razorfen Downs"]=722, ["Razorfen Kraul"]=491, ["Redridge Mountains"]=44, ["Ruins of Ahn'Qiraj"]=3429, ["Ruins of Gilneas"]=4706, ["Ruins of Lordaeron (Undercity)"]=3968, ["Scarlet Monastery"]=796, ["Scholomance"]=2057, ["Searing Gorge"]=51, ["Seat of Life"]=5130, ["Shadowfang Keep"]=209, ["Shadowmoon Valley"]=3520, ["Shattrath City"]=3703, ["Sholazar Basin"]=3711, ["Silithus"]=1377, ["Silvermoon City"]=3487, ["Silverpine Forest"]=130, ["Slitherblade Shore"]=4795, ["Southern Barrens"]=4709, ["Steelspark Station"]=5060, ["Stonetalon Mountains"]=406, ["Stormwind City"]=1519, ["Storm Cliffs"]=4826, ["Strand of the Ancients"]=4384, ["Stranglethorn Vale"]=5339, ["Stratholme"]=2017, ["Sunken Temple"]=1417, ["Sunwell Plateau"]=4075, ["Swamp of Sorrows"]=8, ["Tanaris"]=440, ["Teldrassil"]=141, ["Tempest Keep: The Arcatraz"]=3846, ["Tempest Keep: The Botanica"]=3847, ["Tempest Keep: The Eye"]=3842, ["Tempest Keep: The Mechanar"]=3849, ["Temple of Ahn'Qiraj"]=3428, ["Terokkar Forest"]=3519, ["The Barrens"]=17, ["The Battle For Gilneas"]=5449, ["The Battle for Gilneas (Old City Map)"]=5108, ["The Circle of Blood (Blade's Edge)"]=3702, ["The Crimson Hall"]=4895, ["The Deadmines"]=1581, ["The Exodar"]=3557, ["The Eye of Eternity"]=4500, ["The Forbidding Sea"]=457, ["The Forge of Souls"]=4809, ["The Frost Queen's Lair"]=4893, ["The Frozen Throne"]=4896, ["The Hinterlands"]=47, ["The Lost Isles"]=4707, ["The Maelstrom"]=5416, ["The Nexus: The Eye of Eternity"]=4500, ["The Nexus: The Nexus"]=4120, ["The Nexus: The Oculus"]=4228, ["The North Sea"]=4630, ["The Obsidian Sanctum"]=4493, ["The Park"]=5152, ["The Ring of Trials (Nagrand)"]=3698, ["The Ring of Valor (Orgrimmar)"]=4406, ["The Ruby Sanctum"]=4987, ["The Sanctum of Blood"]=4897, ["The Scarlet Enclave"]=4298, ["The Stockade"]=717, ["The Stonecore"]=5088, ["The Storm Peaks"]=67, ["The Sunspire"]=3430, ["The Veiled Sea"]=457, ["The Violet Hold"]=4415, ["The Vortex Pinnacle"]=5035, ["Thousand Needles"]=400, ["Throne of the Four Winds"]=5638, ["Throne of the Tides"]=5004, ["Throne of Tides"]=5004, ["Thunder Bluff"]=1638, ["Tirisfal Glades"]=85, ["Tol Barad"]=5095, ["Tol Barad Daily Area"]=5389, ["Tol Barad Peninsula"]=5389, ["Transport: Alliance Gunship"]=4763, ["Transport: Horde Gunship"]=4764, ["Transport: Alliance Gunship (IGB)"]=4832, ["Transport: Horde Gunship (IGB)"]=4833, ["Transport: Onyxia/Nefarian Elevator"]=5311, ["Trial of the Champion"]=4723, ["Trial of the Crusader"]=4722, ["Twilight Highlands"]=4922, ["Twin Peaks"]=5031, ["Uldaman"]=1337, ["Ulduar"]=4273, ["Ulduar: Halls of Lightning"]=4272, ["Ulduar: Halls of Stone"]=4264, ["Uldum"]=5034, ["Un'Goro Crater"]=490, ["Utgarde Keep: Utgarde Keep"]=206, ["Utgarde Keep: Utgarde Pinnacle"]=1196, ["Vashj'ir"]=5146, ["Vault of Archavon"]=4603, ["Wailing Caverns"]=718, ["Warsong Gulch"]=3277, ["Well of Eternity"]=5788, ["Western Plaguelands"]=28, ["Westfall"]=40, ["Wetlands"]=11, ["Wintergrasp"]=4197, ["Winterspring"]=618, ["Zangarmarsh"]=3521, ["Zul'Aman"]=3804, ["Zul'Drak"]=66, ["Zul'Farrak"]=978, ["Zul'Gurub"]=19, } local qcg= { ["Inscription"]=773, ["Fishing"]=356, ["Tailoring"]=197, ["Blacksmithing"]=164, ["Leatherworking"]=165, ["Herbalism"]=182, ["Alchemy"]=171, ["Archeology"]=794, ["Cooking"]=185, ["Engineering"]=202, ["Mining"]=186, ["Enchanting"]=333, ["Skinning"]=393, ["Lockpicking"]=633, ["Jewelcrafting"]=755 } local BeastLore=GetSpellInfo(1462); local Disenchanting=GetSpellInfo(13262); local Fishing=GetSpellInfo(33095); local HerbGathering=GetSpellInfo(11993); local Milling=GetSpellInfo(51005); local MindControl=GetSpellInfo(605); local Mining=GetSpellInfo(32606); local Opening=GetSpellInfo(3365); local PickPocketing=GetSpellInfo(921); local Prospecting=GetSpellInfo(31252); local Skinning=GetSpellInfo(13697); local qes={ [BeastLore]=1462, [Disenchanting]=13262, [Fishing]=33095, [HerbGathering]=11993, [Milling]=51005, [MindControl]=605, [Mining]=32606, [Opening]=3365, [PickPocketing]=921, [Prospecting]=31252, [Skinning]=13697, } local qet={ [Disenchanting]=true, [Prospecting]=true, [Milling]=true, [13262]=true, [31252]=true, [51005]=true, } local qev = { [BeastLore]=true, [HerbGathering]=true, [MindControl]=true, [PickPocketing]=true, [Skinning]=true, [1462]=true, [11993]=true, [605]=true, [921]=true, [13697]=true, } local qeu={ [HerbGathering]=true, [Mining]=true, [Opening]=true, [Fishing]=true, [32606]=true, [11993]=true, [3365]=true, [33095]=true, } local zag={ [2663]=99192628, 
} function qch(msgtxt) DEFAULT_CHAT_FRAME:AddMessage(msgtxt) end function qci(appdata) qbo=qbo.."@"..appdata; qbp=qbp+1; if(qbp>10)then table.insert(TTHE,qbo); qbo=""; qbp=0; end end function string:qcj(sep) local sep, fields = sep or ":", {} local pattern = string.format("([^%s]+)", sep) self:gsub(pattern, function(c) fields[#fields+1] = c end) return fields end function qck(s) return (string.gsub(s,"^%s*(.-)%s*$","%1")); end function qcl() SetMapToCurrentZone(); local qcm=GetRealZoneText()or ""; local x,y=GetPlayerMapPosition("player"); local dl=GetCurrentMapDungeonLevel() or 0; if(not x)or(not y)then x,y=0,0; end if(x==0)and(y==0)then for lv=1,GetNumDungeonMapLevels()do SetDungeonMapLevel(lv); x,y=GetPlayerMapPosition("player"); if(x>0)or(y>0)then SetDungeonMapLevel(dl); dl=lv; break; end x,y=0,0; end end if(DungeonUsesTerrainMap())then dl=dl-1; end x=math.floor(x*1000+0.5); y=math.floor(y*1000+0.5); return qcm,dl,x,y; end function qcn(nme) return (nme~=nil)and(nme~="")and(nme:lower()~=unko)and(nme:lower()~=unkb)and(nme:lower()~=unk)and(nme); end function qco(id) if not(id)or(id==nil)then return; end local gid,qcp; if string.match(id,"^0xF.[35]") then qcp="n"; gid=tonumber(string.sub(id,6,10),16); elseif(string.match(id,"^0xF.1"))then qcp="o"; gid=tonumber(string.sub(id,6,10),16); end if(gid==0)then gid=nil; end return gid,qcp; end function qcq(id) return CheckInteractDistance(id,1)and(CheckInteractDistance(id,2))and(CheckInteractDistance(id,3))and(CheckInteractDistance(id,4)); end function eventHandler(self,event,pfx,msg,typ,sdr,uuu) if event=="ADDON_LOADED"and qbl==0 then local a1=pfx; if(a1=="TenTonHammer")then TTHE={}; qbo=""; qbp=0; if(TTHSET==nil)then TTHSET={}; end TTHSET["i"]=1; 
TTHSET["v"]=1; 
TTHSET["c"]=1; 
TTHSET["a"]=1; 
if(GameTooltip:GetScript("OnTooltipSetItem")) then GameTooltip:HookScript("OnTooltipSetItem",qdk); else GameTooltip:SetScript("OnTooltipSetItem",qdk); end if(GameTooltip:GetScript("OnTooltipSetUnit")) then GameTooltip:HookScript("OnTooltipSetUnit",qcu); else GameTooltip:SetScript("OnTooltipSetUnit",qcu); end if(ItemRefTooltip:GetScript("OnTooltipSetUnit")) then ItemRefTooltip:HookScript("OnTooltipSetUnit",qcu); else ItemRefTooltip:SetScript("OnTooltipSetUnit",qcu); end qch("Ten Ton Hammer Collector v"..vsn.." activated."); qci("[89]"..vwcl.."|"..vwcl.."|"..vwcl.."|"..vwcl); qbl=1; qdt(); end elseif event=="PLAYER_ENTERING_WORLD"then qdj(); elseif event=="PLAYER_TARGET_CHANGED"then qcv(); elseif event=="ZONE_CHANGED_NEW_AREA"then qdh(); elseif event=="PLAYER_LOGIN"then qem(); elseif event=="ACHIEVEMENT_EARNED"then qek(pfx,msg); elseif event=="QUEST_DETAIL"then qdc(); elseif event=="QUEST_PROGRESS"then qdd(); elseif event=="MERCHANT_SHOW"then qcr(); elseif event=="QUEST_ACCEPTED"then qdg(); elseif event=="QUEST_COMPLETE"then qcy(); elseif event=="QUEST_LOG_UPDATE"then qde(); elseif event=="LOOT_OPENED"then qcs(); elseif event=="UNIT_SPELLCAST_INTERRUPTED"then qey(pfx); elseif event=="UNIT_SPELLCAST_FAILED"then qey(pfx); elseif event=="UNIT_SPELLCAST_SUCCEEDED"then zaf(pfx,uuu); elseif event=="LOOT_CLOSED"then qez(); elseif event=="CHAT_MSG_MONSTER_EMOTE"then qcx(a1,pfx,msg,typ,sdr); elseif event=="COMBAT_TEXT_UPDATE"then qdq(a1,pfx,msg,typ,sdr); elseif event=="UNIT_COMBAT"then qdr(a1,pfx,msg,typ,sdr); elseif event=="TRAINER_SHOW"then qds(); elseif event=="AUCTION_ITEM_LIST_UPDATE"then qdu(); elseif event=="BANKFRAME_OPENED"then qdx(); elseif event=="AUCTION_HOUSE_SHOW"then qduShow(); elseif event=="BATTLEFIELDS_SHOW"then qdz(); elseif event=="CONFIRM_BINDER"then qea(); elseif event=="CONFIRM_PET_UNLEARN"then qeb(); elseif event=="CONFIRM_TALENT_WIPE"then qec(); elseif event=="OPEN_TABARD_FRAME"then qed(); elseif event=="PET_STABLE_SHOW"then qee(); elseif event=="TAXIMAP_OPENED"then qef(); elseif event=="GUILD_REGISTRAR_SHOW"then qeg(); elseif event=="TRADE_SKILL_SHOW"then qeh(); elseif event=="MAIL_SHOW"then qen(); elseif event=="ITEM_TEXT_BEGIN"then qeo(); elseif event=="ITEM_TEXT_READY"then qep(); elseif event=="UNIT_SPELLCAST_SENT"then qeq(a1,pfx,msg,typ,sdr); end end function qcr() if(TTHSET["m"]~=nil)then return; end if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return; end local oid=UnitGUID("target"); local nid,qcp=qco(oid); if not(nid)or(qcp~="n")then return; end local qdb=1; for y,z in ipairs(qal)do if(z==nid)then qdb=0; end end if(qdb==1)then table.insert(qal,nid); qci("[4]1,2|"..nid..","..qbm.."|285|1"); if(CanMerchantRepair()~=nil)then qci("[4]1,2|"..nid..","..qbm.."|286|1"); end for qas=1,GetMerchantNumItems() do local _,_,qat,qau,qav,_,qaw=GetMerchantItemInfo(qas); local item=GetMerchantItemLink(qas); if(item~=nil)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); if(qat~=nil)then if(qat>0)then qci("[10]1,71|"..nid..","..iid.."|80|"..qat); end end if(qaw~=nil)then qay=GetMerchantItemCostInfo(qas); if(qay~=nil)then local a,b,c= GetMerchantItemCostItem(qas,qay); qdo:ClearLines(); qdo:SetMerchantCostItem(qas,qay); qci("[10]1,71|"..nid..","..iid.."|288|"..b); if(qdoTextLeft1:GetText()~=nil)then qci("[10]1,71|"..nid..","..iid.."|289|"..qdoTextLeft1:GetText()); end if(c~=nil)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); qct(iid); end end end qct(iid); end end end end function qcs() 
if not UnitIsFriend("player","target")and UnitIsTappedByPlayer("target")and UnitIsDead("target")and qcq("target")and qcn(UnitName("target"))then local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if not(qbk)then qez(); return; end local qaw=false; if(qerTarget~=nil)and(qer~=nil)and(UnitName("target")==qerTarget)then qaw=true; else qci("[90]1|"..qbk.."|470|1"); end for sl=1,GetNumLootItems()do if LootSlotIsItem(sl)then local tex,a,b,c,d=GetLootSlotInfo(sl); local item=GetLootSlotLink(sl); if string.match(oid,"^0xF.[35]")and(qbk>0)and(item~=nil)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); if(qaw)then qci("[93]17,71|"..qerTarget..","..iid.."|493|"..qer); else qci("[9]1,71|"..qbk..","..iid.."|287|1"); end qct(iid); end end end else if(qer)or(qerTarget)then local qba=qer or 0; if(qeu[qba])then for sl=1,GetNumLootItems()do if LootSlotIsItem(sl)then local tex,a,b,c,d=GetLootSlotInfo(sl); local item=GetLootSlotLink(sl); if(item~=nil)and(qba>0)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); if(zae~=nil)then if(qer==33095)then local qaz="Fishing"; local qas,dl,x,y=qcl(); if(qas~=nil)then if(string.find(qas,","))then qaz="Fishing"; else qaz=qaz..": "..qas; end end qci("[93]17,71|"..qaz..","..iid.."|493|"..qba); else qci("[93]17,71|"..zae..","..iid.."|493|"..qba); qct(iid); if(qes[zae]~=nil)then local qas,dl,x,y=qcl(); if(qas~=nil)then qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then qci("[94]17,67,68|"..zae..","..x..","..y.."|69|"..qat); end if(dl>0)then qci("[94]17,67,68|"..zae..","..x..","..y.."|102|"..dl); end end end end end end end end end end if(qet[qba])then if(qerTarget)then if(TTHSET["d"]~=nil)then qch("TTH4: "..qerTarget); end end end end end qez(); end function qct(iid) local qdb=1; for y,z in ipairs(qah)do if(z==iid)then qdb=0; end end if(qdb==1)then table.insert(qah,iid); else return; end local qas,qat,qau,qav,qaw,qax,qay,qaz,qba,qas0,qas1 = GetItemInfo(iid); if(qat~=nil)then qdn(qat,iid); end if(qas~=nil)then if(strlen(qas)>0)and(qbm=="en")then qci("[11]1|"..iid.."|17|"..qas); else table.remove(qah,iid); return; end end if(qba~=nil)then if(strlen(qba)>0)then local oslot=qbx[qba]; qci("[11]1|"..iid.."|75|"..oslot); end end if(qas0~=nil)then qci("[11]1|"..iid.."|14|"..qas0); end if(qaz~=nil)then qci("[11]1|"..iid.."|91|"..qaz); end if(qau~=nil)then qci("[11]1|"..iid.."|78|"..qau); end if(qav~=nil)then qci("[11]1|"..iid.."|54|"..qav); end if(qaw~=nil)then if(qaw~="0")then qci("[11]1|"..iid.."|83|"..qaw); end end local oslot=-1; if(qax~=nil)then if(strlen(qax)>0)then oslot=qby[qax]; if(oslot~=nil)then qci("[11]1|"..iid.."|20|"..oslot); else oslot=-1; end end end if(oslot>-1)then if(qay~=nil)then if(strlen(qay)>0)then local osub=qbz[oslot][qay]; if(osub~=nil)then qci("[11]1|"..iid.."|77|"..osub); else qch("ERROR: Unable to lookup slot "..oslot.." and subslot "..qay..". Please email this information to jcsmith@tentonhammer.com"); end end end end if(qas1~=nil)then qci("[11]1|"..iid.."|81|"..qas1); end if(IsEquippableItem(iid)~=nil)then qci("[11]1|"..iid.."|394|1"); end if(IsConsumableItem(iid)~=nil)then qci("[11]1|"..iid.."|395|1"); end if(IsHelpfulItem(iid)~=nil)then qci("[11]1|"..iid.."|396|1"); end if(IsHarmfulItem(iid)~=nil)then qci("[11]1|"..iid.."|397|1"); end qas,_=GetItemUniqueness(iid); if(qas~=nil)then qci("[11]1|"..iid.."|90|"..qas); end qas,_=GetItemSpell(iid); if(qas~=nil)then if(strlen(qas)>0)then qci("[76]1,2|"..iid..","..qbm.."|251|"..qas); end end qas=GetItemCount(iid,nil,true); if(qas~=nil)then if(qas~="0")then if(qas~=0)then qci("[76]1,2|"..iid..","..qbm.."|400|"..qas); end end end qctStats(iid); end function qcu(this,a2) 
if not UnitExists("mouseover")or(UnitIsPlayer("mouseover"))or(UnitPlayerControlled("mouseover"))then return; end qbi=this:GetUnit(); 
if not qcn(qbi)then return; end local oid=UnitGUID("mouseover"); local qbk,qcp=qco(oid); if not(qbk)then return; end if(qcp=="n")then local qdb=1 for y,z in ipairs(qak)do if(z==qbk)then qdb=0; end end if(qdb==1)then qas=0; 
end end end function qcv() 
if(TTHSET["b"]~=nil)then return; end if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return; end local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if not(qbk)then return; end if(qcp=="n")then qbj=UnitName("target"); if not qcn(qbj)then return; end local qdb=1 for y,z in ipairs(qab)do if(z==qbk)then qdb=0; end end if(qdb==1)then table.insert(qab,qbk); qci("[4]1,2|"..qbk..","..qbm.."|17|"..qbj); qbi=UnitCreatureType("target") if(qbi~=nil)then local mtnt=qcd[qbi]; if(mtnt>0)then qci("[4]1,2|"..qbk..","..qbm.."|56|"..mtnt); end end qbi=UnitCreatureFamily("target") if(qbi~=nil)then local mtnt=qcc[qbi]; if(mtnt~=nil)then if(mtnt>0)then qci("[4]1,2|"..qbk..","..qbm.."|57|"..mtnt); end end end qbi=UnitClassification("target") if(qbi~=nil)then local mtnt=qcaIFICATION[qbi]; if(mtnt~=nil)then if(mtnt>=0)then qci("[4]1,2|"..qbk..","..qbm.."|58|"..mtnt); end end end qbj,qbi=UnitClass("target"); if(qbi~=nil)then local mtnt = qca[qbi]; if(mtnt >0)then qci("[4]1,2|"..qbk..","..qbm.."|59|"..mtnt); end end qbi=UnitHealthMax("target"); if(qbi>0)then qci("[5]1,2|"..qbk..","..qbm.."|60|"..qbi); end qbi=UnitPowerMax("target"); if(qbi>0)then qci("[5]1,2|"..qbk..","..qbm.."|61|"..qbi); end qbi=UnitSex("target"); if(qbi>0)then qci("[4]1,2|"..qbk..","..qbm.."|62|"..qbi); end qbi=UnitLevel("target"); if(qbi>0)then qci("[5]1,2|"..qbk..","..qbm.."|63|"..qbi); qci("[6]1,2|"..qbk..","..qbm.."|64|"..qbi); end qbi=UnitReaction("player","target"); if(qbi~=nil and qbf~=nil)then if(qbf=="Alliance")then qci("[4]1,2|"..qbk..","..qbm.."|65|"..qbi); elseif(qbf=="Horde")then qci("[4]1,2|"..qbk..","..qbm.."|66|"..qbi); end end if not UnitIsTapped("target")and qcq("target")then qas,dl,x,y=qcl(); if(qas~=nil)then qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then if(qat~="0")then qci("[7]1,67,68|"..qbk..","..x..","..y.."|69|"..qat); end end if(dl>0)then qci("[7]1,67,68|"..qbk..","..x..","..y.."|102|"..dl); end end end end qdo:SetOwner(frame,"ANCHOR_NONE"); qdo:ClearLines(); qdo:SetUnit("target"); for line=2,3 do local qba=getglobal("qdoTextLeft"..line):GetText(); if(qba~=nil)then if(qcw(qba)==true)then qci("[4]1,2|"..qbk..","..qbm.."|55|"..qba); end end end end end end function qcw(nme) if(qbq==true)then local y=1; qbq=false; while(y<=GetNumFactions())do local qas,_,_,_,_,_,_,_,_,_=GetFactionInfo(y); table.insert(qan,qas); y=y+1; end end local result=false; for y,z in ipairs(qan)do if(z==nme)then result=true; end end return result; end function qcx(emote,name,msg,typ,sdr) if(TTHSET["s"]~=nil)then return; end if(emote=="%s attempts to run away in fear!")then local qdb=1; for y,z in ipairs(qam)do if(z==name)then qdb=0; end end if(qdb==1)then table.insert(qam,name); if not(name)then return; end qci("[4]17,2|"..name..","..qbm.."|428|1"); end end end function qcy()
if(TTHSET["q"]~=nil)then return; end local questTiqci=GetTitleText(); local qda=qdi(questTiqci); if(qda~=nil)then if(qda=="0")then return; end local qdb=1; for y,z in ipairs(qad)do if(z==qda)then qdb=0; end end if(qdb==1)then table.insert(qad,qda); else return; end if UnitExists("target")and not UnitPlayerControlled("target")then qbj=UnitName("target"); local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if(qbk~=nil)then qci("[1]1,2|"..qda..","..qbm.."|52|"..qbk); end end qas=GetRewardText(); if(qas~=nil)then if(strlen(qas)>1)then qci("[72]1,2|"..qda..","..qbm.."|345|"..qas); end end qbt=qda; qbu=GetTime(); end end function qdc()
if(TTHSET["q"]~=nil)then return; end local questTiqci=GetTitleText(); local qda=qdi(questTiqci); if(qda~=nil)then if(qda=="0")then return; end local qdb=1; for y,z in ipairs(qae)do if(z==qda)then qdb=0; end end if(qdb==1)then table.insert(qae,qda); else return; end if(UnitName("questnpc")~=nil)and(UnitIsPlayer("questnpc")==nil)then local nid,qcp=qco(UnitGUID("questnpc")); if (nid~=nil)and(qcp=="o")then local qdb=1; qci("[3]1,2|"..qda..","..qbm.."|471|"..nid); for y,z in ipairs(qaj)do if(z==nid)then qdb=0; end end if(qdb==1)then table.insert(qaj,nid); local qbj = UnitName("questnpc"); if(qbj~=nil)then qci("[91]1,2|"..nid..","..qbm.."|17|"..qbj); local qas,dl,x,y=qcl(); if(qas~=nil)then local qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then if(qat~="0")then qci("[7]1,67,68|"..nid..","..x..","..y.."|69|"..qat); elseif(TTHSET["d"]~=nil)then qch("TTH1: "..qas); end end if(dl>0)then qci("[7]1,67,68|"..nid..","..x..","..y.."|102|"..dl); end end end end end end end qas=QuestFlagsPVP(); if(qas~=nil)then qci("[1]1,2|"..qda..","..qbm.."|215|1"); end qas=GetRewardHonor(); if(qas~=nil)then qci("[1]1,2|"..qda..","..qbm.."|391|1"); end end end function qdd()
if(TTHSET["q"]~=nil)then return; end local questTiqci=GetTitleText(); local qda=qdi(questTiqci); if(qda~=nil)then if(qda=="0")then return; end local qdb=1; for y,z in ipairs(qaf)do if(z==qda)then qdb=0; end end if(qdb==1)then table.insert(qaf,qda); else return; end end end function qde() if(TTHSET["q"]~=nil)then return; end local qdf=GetQuestLogSelection(); local _,tqax,tqay,tqaz,tqba,_,_,_,qda=GetQuestLogTitle(qdf); if(qda~=nil)then if(qda=="0")or(qda<1)then return; end local qdb=1; for y,z in ipairs(qag)do if(z==qda)then qdb=0; end end if(qdb==1)then table.insert(qag,qda); else return; end qas,qat=GetQuestLogQuestText(); SelectQuestLogEntry(qdf); if(qat~=nil)then if(strlen(qat)>1)then qci("[74]1,2|"..qda..","..qbm.."|348|"..qat); end end if(qas~=nil)then if(strlen(qas)>1)then qci("[72]1,2|"..qda..","..qbm.."|19|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRequiredMoney(); if(qas~=nil)then if(qas>0)then qci("[1]1,2|"..qda..","..qbm.."|390|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRewardSpell(); if(qas~=nil)then if(strlen(qas)>0)then qci("[1]1,2|"..qda..","..qbm.."|251|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogPushable() if(qas~=nil)then if(qas>0)then qci("[14]1,2|"..qda..","..qbm.."|349|1"); end end SelectQuestLogEntry(qdf); qas=GetQuestLogTimeLeft() if(qas~=nil)then if(qas>0)then qci("[75]1,2|"..qda..","..qbm.."|388|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRewardXP() if(qas~=nil)then if(qas>0)then qci("[14]1,2|"..qda..","..qbm.."|389|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRewardTalents() if(qas~=nil)then if(qas>0)then qci("[1]1,2|"..qda..","..qbm.."|205|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRewardTalents() if(qas~=nil)then if(qas>0)then qci("[1]1,2|"..qda..","..qbm.."|205|"..qas); end end SelectQuestLogEntry(qdf); qas=GetQuestLogRewardTitle() if(qas~=nil)then if(qas>0)then qci("[1]1,2|"..qda..","..qbm.."|98|"..qas); end end SelectQuestLogEntry(qdf); qas,_,_=GetQuestLogSpecialItemInfo(qdf) if(qas~=nil)then local iid=tonumber(qas:match("[a-z]+:(%-?%d+)")); qct(iid); if(iid>0)then qci("[1]1,2|"..qda..","..qbm.."|392|"..iid); end end SelectQuestLogEntry(qdf); for i=1,GetNumQuestLeaderBoards(),1 do qas,qat,_ = GetQuestLogLeaderBoard(i); if(qas~=nil)then if(string.find(qas,":"))then if(qat=="item")then qau=string.qcj(qas)[1]; qav=string.qcj(qas,"/")[2]; qas0=379+i; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qau); if(strlen(qav)>0)then qas0=qas0+4; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qav); end elseif(qat=="monster")then qau=string.qcj(qas)[1]; qav=string.qcj(qas,"/")[2]; qas0=371+i; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qau); if(strlen(qav)>0)then qas0=qas0+4; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qav); end end end end end if(tqax~=nil)then if(tqax~="0")then qci("[14]1,2|"..qda..","..qbm.."|102|"..tqax); end end if(tqaz~=nil)then if(tqaz~="0")then qci("[14]1,2|"..qda..","..qbm.."|351|"..tqaz); end end SelectQuestLogEntry(qdf); for i=1,GetNumQuestLogChoices(),1 do _,_,qat,_,_=GetQuestLogChoiceInfo(i); 
qau=GetQuestLogItemLink("choice",i); if(qau~=nil)then local iid=tonumber(qau:match("[a-z]+:(%-?%d+)")); qct(iid); qas0=359+i; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..iid); if(strlen(qat)>0)then qas0=qas0+6; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qat); end end end SelectQuestLogEntry(qdf); for i=1,GetNumQuestLogRewards(),1 do _,_,qat,_,_=GetQuestLogRewardInfo(i); 
qau=GetQuestLogItemLink("reward",i); if(qau~=nil)then local iid=tonumber(qau:match("[a-z]+:(%-?%d+)")); qct(iid); qas0=351+i; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..iid); if(strlen(qat)>0)then qas0=qas0+4; qci("[1]1,2|"..qda..","..qbm.."|"..qas0.."|"..qat); end end end end end function qdg()
if(TTHSET["q"]~=nil)then return; end local questTiqci=GetTitleText(); local qda=qdi(questTiqci); if(qda~=nil)then if(qda=="0")then return; end local qdb=1; for y,z in ipairs(qac)do if(z==qda)then qdb=0; end end if(qdb==1)then table.insert(qac,qda); else return; end if(UnitName("questnpc")~=nil)then local nid,qcp=qco(UnitGUID("questnpc")); if (nid~=nil)and(qcp=="o")then local qdb=1; qci("[3]1,2|"..qda..","..qbm.."|471|"..nid); for y,z in ipairs(qaj)do if(z==nid)then qdb=0; end end if(qdb==1)then table.insert(qaj,nid); local qbj = UnitName("questnpc"); if(qbj~=nil)then qci("[91]1,2|"..nid..","..qbm.."|17|"..qbj); local qas,dl,x,y=qcl(); if(qas~=nil)then local qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then if(qat~="0")then qci("[7]1,67,68|"..nid..","..x..","..y.."|69|"..qat); elseif(TTHSET["d"]~=nil)then qch("TTH1: "..qas); end end if(dl>0)then qci("[7]1,67,68|"..nid..","..x..","..y.."|102|"..qat); end end end end end end end if UnitExists("target")and not UnitPlayerControlled("target")then qbj=UnitName("target"); local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if(qbk~=nil)then qci("[1]1,2|"..qda..","..qbm.."|53|"..qbk); end if(qbf~=nil)then if(qbf=="Alliance")then qci("[3]1,2|"..qda..","..qbm.."|55|a"); else qci("[3]1,2|"..qda..","..qbm.."|55|h"); end end end if(QuestIsDaily()~=nil)then qci("[14]1,2|"..qda..","..qbm.."|343|1"); end if(QuestIsWeekly()~=nil)then qci("[14]1,2|"..qda..","..qbm.."|344|1"); end qas=GetGreetingText(); if(qas~=nil)then if(strlen(qas)>1)then qci("[72]1,2|"..qda..","..qbm.."|346|"..qas); end end end end function qdh() 
if (not BattlefieldMinimap or not BattlefieldMinimap:IsShown()) and (not WorldMapFrame or not WorldMapFrame:IsShown())then WorldMapFrame:Show(); SetMapToCurrentZone(); WorldMapFrame:Hide(); end local qcm=GetRealZoneText()or ""; local nid=qcf[qcm]; if(nid==nil)then return; end local qdb=1; for y,z in ipairs(qar)do if(z==nid)then qdb=0; end end if(qdb==1)then table.insert(qar,nid); local qas=GetCurrentMapContinent(); qci("[19]1,2|"..nid..","..qbm.."|494|"..qas); end end function qdi(name) for x=GetNumQuestLogEntries(),1,-1 do local a,b,c,d,hDe,cPe=GetQuestLogTitle(x); if(hDe)and(cPe)then qbn[a]=true; ExpandQuestHeader(x); end end local got for x=GetNumQuestLogEntries(),1,-1 do local a,b,c,d,hDe=GetQuestLogTitle(x); if(hDe)then if(qbn[a])then CollapseQuestHeader(x); qbn[a]=nil; end elseif not(got)and(a==name)then local link=GetQuestLink(x) if(link)then local id=link:match("^|c%x%x%x%x%x%x%x%x|Hquest:(%d+):"); if(id)then got=id; end end end end if(got)then return got end return nil end function qdj() 
qbm="un"; if(GetLocale()=="frFR")then qbm="fr"; elseif(GetLocale()=="enGB")then qbm="en"; elseif(GetLocale()=="enUS")then qbm="en"; elseif(GetLocale()=="deDE")then qbm="de"; elseif(GetLocale()=="esES")then qbm="es"; elseif(GetLocale()=="esMX")then qbm="mx"; elseif(GetLocale()=="zhTW")then qbm="tw"; elseif(GetLocale()=="zhCN")then qbm="cn"; elseif(GetLocale()=="koKR")then qbm="kr"; elseif(GetLocale()=="ruRU")then qbm="ru"; end qbe=UnitName("player"); qbg=GetRealmName(); _,qbh=UnitClass("player"); qbf,_=UnitFactionGroup("player"); qab={}; qak={}; qah={}; qai={}; qaj={}; qac={}; qad={}; qae={}; qaf={}; qag={}; qal={}; qaq={}; qei={}; qam={}; qan={}; qao={}; qap={}; qbq=true; end function qdk(this) 
local qbi,qas=this:GetItem(); 
if not qcn(qbi)then return; end if(qas~=nil)then local qaz=tonumber(qas:match("[a-z]+:(%-?%d+)")); if(qaz==llid)then return; end llid=qaz; qct(qaz); end end function qctStats(iid) table.wipe(qao); local ditid="item:"..iid; GetItemStats(ditid,qao); for stat,qdm in pairs(qce) do qba=qao[stat]; if(qba~=nil)then qci("[71]1|"..iid.."|"..qdm.."|"..qba); end end end function qdn(link,iid) qdo:SetOwner(frame,"ANCHOR_NONE"); qdo:ClearLines(); qdo:SetHyperlink(link); local qas,qat,qau,qav,qaw; local numLines=qdo:NumLines(); local sksl=1; 
local qej=true; qas=""; for line=1,numLines do qat=getglobal("qdoTextLeft"..line); qau=qat:GetText(); if(qau~=nil)then local _,a1=string.gsub(qau,"Socket",""); if(a1>0)then local _,a2=string.gsub(qau,"Socket Bonus: ",""); if(a2>0)then qav=string.gsub(qau,"Socket Bonus: ",""); qci("[71]1|"..iid.."|469|"..qav); end if(qau=="Red Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|1"); sksl=sksl+1; end if(qau=="Blue Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|2"); sksl=sksl+1; end if(qau=="Yellow Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|3"); sksl=sksl+1; end if(qau=="Purple Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|4"); sksl=sksl+1; end if(qau=="Green Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|5"); sksl=sksl+1; end if(qau=="Orange Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|6"); sksl=sksl+1; end if(qau=="Meta Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|7"); sksl=sksl+1; end if(qau=="Simple Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|8"); sksl=sksl+1; end if(qau=="Prismatic Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|9"); sksl=sksl+1; end if(qau=="Hydraulic Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|10"); sksl=sksl+1; end if(qau=="Cogwheel Socket")and(sksl<4)then qaw=sksl+445; qci("[11]1|"..iid.."|"..qaw.."|11"); sksl=sksl+1; end end if(qej==true)then local _,a1=string.gsub(qau," Armor",""); if(a1>0)then qav=string.gsub(qau," Armor",""); qci("[71]1|"..iid.."|73|"..qav); end end local _,a1=string.gsub(qau,"Use: ",""); if(a1>0)then qav=string.gsub(qau,"Use: ",""); qci("[76]1,2|"..iid..","..qbm.."|393|"..qav); qej=false; end local _,a1=string.gsub(qau,"Requires ",""); if(a1>0)then qav=string.gsub(qau,"Requires ",""); local _,a1=string.gsub(qau,"Requires ",""); if(a1>0)then qej=false; qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then local qax=qck(qaw[1]); if(qcw(qax)==true)then qci("[11]1|"..iid.."|55|"..qax); if(qaw[2]~=nil)then qax=qck(qaw[2]); qci("[11]1|"..iid.."|431|"..qax); end end end end end local _,a1=string.gsub(qau," Nature Resistance",""); if(a1>0)then qav=string.gsub(qau," Nature Resistance",""); qci("[71]1|"..iid.."|121|"..qav); end local _,a1=string.gsub(qau," Holy Resistance",""); if(a1>0)then qav=string.gsub(qau," Holy Resistance",""); qci("[71]1|"..iid.."|119|"..qav); end local _,a1=string.gsub(qau," Fire Resistance",""); if(a1>0)then qav=string.gsub(qau," Fire Resistance",""); qci("[71]1|"..iid.."|120|"..qav); end local _,a1=string.gsub(qau," Frost Resistance",""); if(a1>0)then qav=string.gsub(qau," Frost Resistance",""); qci("[71]1|"..iid.."|122|"..qav); end local _,a1=string.gsub(qau," Shadow Resistance",""); if(a1>0)then qav=string.gsub(qau," Shadow Resistance",""); qci("[71]1|"..iid.."|123|"..qav); end local _,a1=string.gsub(qau," Arcane Resistance",""); if(a1>0)then qav=string.gsub(qau," Arcane Resistance",""); qci("[71]1|"..iid.."|124|"..qav); end local _,a1=string.gsub(qau,"Binds when picked up",""); if(a1>0)then qci("[11]1|"..iid.."|405|1"); end local _,a1=string.gsub(qau,"Binds when used",""); if(a1>0)then qci("[11]1|"..iid.."|405|3"); end local _,a1=string.gsub(qau,"Binds when equipped",""); if(a1>0)then qci("[11]1|"..iid.."|405|2"); end local _,a1=string.gsub(qau,"Binds to account",""); if(a1>0)then qci("[11]1|"..iid.."|405|4"); end local _,a1=string.gsub(qau," Bag",""); if(a1>0)then local _,a2=string.gsub(qau," Slot Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Engineering Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Engineering Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Soul Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Soul Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Herb Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Herb Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Enchanting Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Enchanting Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Gem Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Gem Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Mining Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Mining Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Leatherworking Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Leatherworking Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Slot Inscription Bag",""); if(a2>0)then qav=string.gsub(qau," Slot Inscription Bag",""); qci("[11]1|"..iid.."|92|"..qav); end local _,a2=string.gsub(qau," Tackle Box",""); if(a2>0)then qav=string.gsub(qau," Tackle Box",""); qci("[11]1|"..iid.."|92|"..qav); end end local _,a1=string.gsub(qau,"Classes: ",""); if(a1>0)then local _,a2=string.gsub(qau,"Warrior",""); if(a2>0)then qci("[21]1|"..iid.."|59|1"); end local _,a2=string.gsub(qau,"Paladin",""); if(a2>0)then qci("[21]1|"..iid.."|59|2"); end local _,a2=string.gsub(qau,"Hunter",""); if(a2>0)then qci("[21]1|"..iid.."|59|3"); end local _,a2=string.gsub(qau,"Rogue",""); if(a2>0)then qci("[21]1|"..iid.."|59|4"); end local _,a2=string.gsub(qau,"Priest",""); if(a2>0)then qci("[21]1|"..iid.."|59|5"); end local _,a2=string.gsub(qau,"Death Knight",""); if(a2>0)then qci("[21]1|"..iid.."|59|6"); end local _,a2=string.gsub(qau,"Shaman",""); if(a2>0)then qci("[21]1|"..iid.."|59|7"); end local _,a2=string.gsub(qau,"Mage",""); if(a2>0)then qci("[21]1|"..iid.."|59|8"); end local _,a2=string.gsub(qau,"Warlock",""); if(a2>0)then qci("[21]1|"..iid.."|59|9"); end local _,a2=string.gsub(qau,"Druid",""); if(a2>0)then qci("[21]1|"..iid.."|59|11"); end end local _,a1=string.gsub(qau,"Races: ",""); if(a1>0)then local _,a2=string.gsub(qau,"Undead",""); if(a2>0)then qci("[21]1|"..iid.."|82|1"); end local _,a2=string.gsub(qau,"Blood Elf",""); if(a2>0)then qci("[21]1|"..iid.."|82|2"); end local _,a2=string.gsub(qau,"Human",""); if(a2>0)then qci("[21]1|"..iid.."|82|3"); end local _,a2=string.gsub(qau,"Draenei",""); if(a2>0)then qci("[21]1|"..iid.."|82|4"); end local _,a2=string.gsub(qau,"Night Elf",""); if(a2>0)then qci("[21]1|"..iid.."|82|5"); end local _,a2=string.gsub(qau,"Tauren",""); if(a2>0)then qci("[21]1|"..iid.."|82|6"); end local _,a2=string.gsub(qau,"Orc",""); if(a2>0)then qci("[21]1|"..iid.."|82|7"); end local _,a2=string.gsub(qau,"Gnome",""); if(a2>0)then qci("[21]1|"..iid.."|82|8"); end local _,a2=string.gsub(qau,"Troll",""); if(a2>0)then qci("[21]1|"..iid.."|82|9"); end local _,a2=string.gsub(qau,"Dwarf",""); if(a2>0)then qci("[21]1|"..iid.."|82|10"); end local _,a2=string.gsub(qau,"Worgen",""); if(a2>0)then qci("[21]1|"..iid.."|82|11"); end local _,a2=string.gsub(qau,"Goblin",""); if(a2>0)then qci("[21]1|"..iid.."|82|12"); end end local _,a1=string.gsub(qau," Damage",""); if(a1>0)then local qdp=false; local _,a1=string.gsub(qau,"Fire Damage",""); if(a1>0)then qav=string.gsub(qau," Fire Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|1"); qdp=true; end if(qdp==false)then local _,a1=string.gsub(qau,"Frost Damage",""); if(a1>0)then qav=string.gsub(qau,"Frost Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|3"); qdp=true; end end if(qdp==false)then local _,a1=string.gsub(qau,"Holy Damage",""); if(a1>0)then qav=string.gsub(qau," Holy Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|6"); qdp=true; end end if(qdp==false)then local _,a1=string.gsub(qau,"Arcane Damage",""); if(a1>0)then qav=string.gsub(qau," Arcane Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|5"); qdp=true; end end if(qdp==false)then local _,a1=string.gsub(qau,"Nature Damage",""); if(a1>0)then qav=string.gsub(qau," Nature Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|2"); qdp=true; end end if(qdp==false)then local _,a1=string.gsub(qau,"Shadow Damage",""); if(a1>0)then qav=string.gsub(qau," Shadow Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[1]); end qci("[71]1|"..iid.."|409|4"); qdp=true; end end if(qdp==false)then qav=string.gsub(qau," Damage",""); qaw=string.qcj(qav,"-"); if(qaw[1]~=nil)then qci("[71]1|"..iid.."|407|"..qaw[1]); end if(qaw[2]~=nil)then qci("[71]1|"..iid.."|408|"..qaw[2]); end end end local _,a1=string.gsub(qau,"Durability",""); if(a1>0)then qej=false; end local _,a1=string.gsub(qau,"Item Lev",""); if(a1>0)then qej=false; end local _,a1=string.gsub(qau,"Equip:",""); if(a1>0)then local _,a1=string.gsub(qau,"the cooldown of your",""); if (a1>0)then qav=string.gsub(qau,"Equip: ",""); qci("[76]1,2|"..iid..","..qbm.."|394|"..qav); end local _,a1=string.gsub(qau," have a chance to ",""); if (a1>0)then qav=string.gsub(qau,"Equip: ",""); qci("[76]1,2|"..iid..","..qbm.."|394|"..qav); end qej=false; end end qat=getglobal("qdoTextRight"..line); qau=qat:GetText(); if(qau~=nil)then local _,a1=string.gsub(qau,"Speed ",""); if(a1>0)then qav=string.gsub(qau,"Speed ",""); qci("[71]1|"..iid.."|406|"..qav); end end end end function qdq(a1,pfx,msg,typ,sdr) if(pfx=="FACTION")then if(typ==nil)or(msg==nil)then return; end if(qbs==nil)or(qbr==nil)then if(qbt==nil)or(qbu==nil)then return; end if((GetTime())-(qbu)<1)then if(string.find(msg,"-"))then qci("[16]1,2|"..qbt..","..qbm.."|430|"..msg); else qci("[16]1,2|"..qbt..","..qbm.."|429|"..msg); end qbt=nil; qbu=nil; else qbt=nil; qbu=nil; end return; end if((GetTime())-(qbs)<1)then if(string.find(msg,"-"))then qci("[22]1,2|"..qbr..","..qbm.."|430|"..msg); else qci("[22]1,2|"..qbr..","..qbm.."|429|"..msg); end qbr=nil; qbs=nil; else qbr=nil; qbs=nil; end end end function qdr(a1,pfx,msg,typ,sdr) if(pfx=="target")and(msg=="WOUND")then if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return; end local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if not(qbk)then qbr=nil; qbs=nil; return; end qbr=qbk; qbs=GetTime(); end end function qds() if(TTHSET["t"]~=nil)then return; end if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return; end local oid=UnitGUID("target"); local nid,qcp=qco(oid); if not(nid)or(qcp~="n")then return; end local qdb=1; for y,z in ipairs(qap)do if(z==nid)then qdb=0; end end if(qdb==1)then local gid=qdv(); qdw(gid,4) local tradeskill=IsTradeskillTrainer(); local iid,qas,qat,qau,qav,qaw,qax; for i=1,GetNumTrainerServices() do qas,qat,qau,_,qav=GetTrainerServiceInfo(i); if(qau~="header")then if(qas)then qdo:SetTrainerService(i); local _,_,qaw=qdo:GetSpell(); if(qaw~=nil)then local qaz=GetSpellDescription(qaw); if(qaz~=nil)then qci("[83]1,2|"..qaw..","..qbm.."|19|"..qaz); end if(tradeskill==nil)then qci("[82]1,251|"..nid..","..qaw.."|436|0"); if(qau=="used")or(qau=="available")then qci("[84]1|"..qaw.."|102|"..UnitLevel("player")); end else qci("[82]1,251|"..nid..",".. qaw.."|436|1"); end local skill,rank,_=GetTrainerServiceSkillReq(i); if(skill~=nil)then local qaz=qcg[skill]; if(qaz~=nil)then qci("[82]1,251|"..nid..",".. qaw.."|438|"..qaz); end end if(rank~=nil)then qci("[82]1,251|"..nid..",".. qaw.."|411|"..rank); end local qaz,_,_=GetTrainerServiceCost(i); if(qaz~=nil)then qci("[82]1,251|"..nid..",".. qaw.."|439|"..qaz); end local item=GetTrainerServiceItemLink(i); if(item~=nil)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); qct(iid); qci("[82]1,251|"..nid..",".. qaw.."|437|"..iid) end end end end end end end function qdt() if(TTHSET["g"]~=nil)then return; end if(qbv~=nil)then return; end qbv=true; for i=1,NUM_GLYPH_SLOTS do local _,qas,_,qat,_=GetGlyphSocketInfo(i); if(qat~=nil)and(qas~=nil)then qci("[85]1|"..qat.."|440|"..qas); local qaz=GetSpellDescription(qat); if(qaz~=nil)then qci("[83]1,2|"..qat..","..qbm.."|19|"..qaz); end qci("[84]1|"..qat.."|102|"..UnitLevel("player")); end end end function qdu() if(TTHSET["v"]~=nil)then return; end if(qbw>0)then qbw=qbw-1; else return; end for i=1,GetNumAuctionItems("list") do local item=GetAuctionItemLink("list",i) if(item)then local iid=tonumber(item:match("[a-z]+:(%-?%d+)")); qct(iid); local _,_,qas,_,_,_,_,_,qat,_,_,_=GetAuctionItemInfo("list",i); if(qas~=nil)and(qat~=nil)then qci("[86]1|"..iid.."|441|1"); local qau=qat/qas; local qau=ceil(qau*0.0001); qci("[86]1|"..iid.."|442|"..qau); end end end end function qdv() if(TTHSET["z"]~=nil)then return nil; end if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return nil; end local oid=UnitGUID("target"); local nid,qcp=qco(oid); if not(nid)or(qcp~="n")then return nil; end local qdb=1; for y,z in ipairs(qaq)do if(z==nid)then qdb=0; end end if(qdb==1)then return nid; end return nil; end function qdw(nid,ntype) if(nid~=nil)then table.insert(qaq,nid); qci("[4]1|"..nid.."|443|"..ntype); end end function qdx() local nid=qdv(); qdw(nid,2) end function qduShow() local nid=qdv(); qdw(nid,1) end function qdz() local nid=qdv(); qdw(nid,3) end function qea() local nid=qdv(); qdw(nid,7) end function qeb() local nid=qdv(); qdw(nid,11) end function qec() local nid=qdv(); qdw(nid,9) end function qed() local nid=qdv(); qdw(nid,10) end function qee() local nid=qdv(); qdw(nid,8) end function qef() local nid=qdv(); qdw(nid,5) end function qeg() local nid=qdv(); qdw(nid,6) end function qeh() frame:UnregisterEvent("TRADE_SKILL_SHOW"); 
if(TTHSET["c"]~=nil)then frame:RegisterEvent("TRADE_SKILL_SHOW"); return; end local qax=GetTradeSkillLine(); if(qax~=nil)then if(qda=="UNKNOWN")then frame:RegisterEvent("TRADE_SKILL_SHOW"); return; end local qdb=1; for y,z in ipairs(qei)do if(z==qax)then qdb=0; end end if(qdb==1)then table.insert(qei,qax); local i,qas,qat,qau,qav,qaw,qay,qaz; i=1; while(i<=GetNumTradeSkills())do local qat,qau,_,qav=GetTradeSkillInfo(i); if(qat)then if not(qau=="header")then qaw=GetTradeSkillRecipeLink(i); local _,_,qas=string.find(qaw,"^|%x+|Henchant:(.+)|h%[.+%]"); if(qas~=nil)then SelectTradeSkill(i); qay=GetTradeSkillDescription(i); if(qay~=nil)then qci("[66]1,2|"..qas..","..qbm.."|19|"..qay); end qay,qaz=GetTradeSkillNumMade(i); if(qay~=nil)then qci("[88]1|"..qas.."|452|"..qay); end if(qaz~=nil)then qci("[88]1|"..qas.."|466|"..qaz); end local j=1; while(j<=GetTradeSkillNumReagents(i))do _,_,qay,_=GetTradeSkillReagentInfo(i,j); if(qay~=nil)then qaz=j+459; qci("[88]1|"..qas.."|"..qaz.."|"..qay); end qay=GetTradeSkillReagentItemLink(i,j); if(qay~=nil)then qba=j+453; qaz=tonumber(qay:match("[a-z]+:(%-?%d+)")); qci("[88]1|"..qas.."|"..qba.."|"..qaz); qct(qaz); end j=j+1; if(j>6)then j=99; end end end end end i = i + 1; end end end frame:RegisterEvent("TRADE_SKILL_SHOW"); end function qek(qas) if(qas~=nil)then local _,qav,qaw,_,_,_,_,qax,_,qay,_,qat = GetAchievementInfo(qas); if (qav~=nil)then qci("[32]1,2|"..qas..","..qbm.."|17|"..qav); end if (qaw~=nil)then qci("[32]1,2|"..qas..","..qbm.."|96|"..qaw); end if (qax~=nil)then qci("[32]1,2|"..qas..","..qbm.."|19|"..qax); end qat = GetAchievementCategory(qas); if (qat~=nil)then qci("[32]1,2|"..qas..","..qbm.."|97|"..qat); end qat,_ = GetNextAchievement(qas); if (qat~=nil)then qci("[32]1,2|"..qas..","..qbm.."|467|"..qat); end qat,_ = GetPreviousAchievement(qas); if (qat~=nil)then qci("[32]1,2|"..qas..","..qbm.."|468|"..qat); end end end function qem() for lv=1,19 do local qas=GetInventoryItemID("player",lv); if(qas~=nil)then local _,qat=GetInventoryItemDurability(lv); if(qat~=nil)then qci("[11]1|"..qas.."|404|"..qat); end end end for bg=0,4 do local sl=GetContainerNumSlots(bg); for lv=1,sl do local qas=GetContainerItemID(bg,lv); if(qas~=nil)then local _,qat=GetContainerItemDurability(bg,lv); if(qat~=nil)then qci("[11]1|"..qas.."|404|"..qat); end end end end end function qep() if(UnitName("npc")==nil)then return; end if(strlen(UnitName("npc"))==0)then return; end local nid,qcp=qco(UnitGUID("npc")); if not(nid)or(qcp~="o")then return; end local qbj=UnitName("npc"); if(qbj~=nil)then local qau=ItemTextGetPage(); if(qau~=nil)then if(qau>0)and(qau<21)then local qav=qau+471; local qaw=ItemTextGetText(); if(qaw~=nil)then qci("[92]1|"..nid.."|"..qav.."|"..qaw); end end end end end function qen() if(UnitName("npc")==nil)then return; end if(strlen(UnitName("npc"))==0)then return; end local nid,qcp=qco(UnitGUID("npc")); if not(nid)or(qcp~="o")then return; end local qdb=1; for y,z in ipairs(qaj)do if(z==nid)then qdb=0; end end if(qdb==1)then table.insert(qaj,nid); local qbj=UnitName("npc"); if(qbj~=nil)and(UnitIsPlayer("npc")==nil)then if(qbj=="Mailbox")then nid=99999999; end qci("[91]1,2|"..nid..","..qbm.."|17|"..qbj); local qas,dl,x,y=qcl(); if(qas~=nil)then local qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then if(qat~="0")then qci("[7]1,67,68|"..nid..","..x..","..y.."|69|"..qat); elseif(TTHSET["d"]~=nil)then qch("TTH1: "..qas); end end if(dl>0)then qci("[7]1,67,68|"..nid..","..x..","..y.."|102|"..dl); end end end end end end function qeo() if(UnitName("npc")==ItemTextGetItem())then qen(); end end function zaf(qas,qat) if(qas=="target")then if not UnitExists("target")or(UnitPlayerControlled("target"))or(UnitIsPlayer("target"))then return; end local oid=UnitGUID("target"); local qbk,qcp=qco(oid); if not(qbk)then return; end if(qcp=="n")then qci("[95]1,251|"..qbk..","..qat.."|225|1"); end end if(qas~="player")then return; end if(qer==nil)and(qex==nil)then local nid=zag[qat]; if(nid~=nil)then local qas,dl,x,y=qcl(); if(qas~=nil)then local qat=qcf[qas]; if(x>0)or(y>0)or(qat~=nil)then if(qat~=nil)then if(qat~="0")then qci("[7]1,67,68|"..nid..","..x..","..y.."|69|"..qat); elseif(TTHSET["d"]~=nil)then qch("TTH1: "..qas); end end if(dl>0)then qci("[7]1,67,68|"..nid..","..x..","..y.."|102|"..dl); end end end end end if(qer~=nil)then return; 
end qez(); end function qey(qas) if(qas~="player")then return; end qez(); end function qez() qerTarget=nil; qer=nil; qex=nil; zae=nil; end function qeq(qas,qat,qau,qav,qaw) if(qat~="player")or not qaw then return; end if(qes[qau])then qer=qes[qau]; qerTarget=(qaw~="")and(qaw or UnitName("mouseover") or GameTooltipTextLeft1:GetText()); qex=nil; if(qeu[qau])then for i=1,_G.GameTooltip:NumLines()do local qba=_G["GameTooltipTextLeft"..i]:GetText(); if(qba~=nil)and(string.find(qba,"Requires"))then qex=string.gsub(qba,"Requires ",""); end end if(qex~=nil)then zae=_G.GameTooltipTextLeft1:GetText(); else zae=nil; end else zae=nil; end else qez(); end end SLASH_TTHDISABLENPCCOLLECT1 = '/tthdisablenpccollect'; function SlashCmdList.TTHDISABLENPCCOLLECT(msg,editbox) qch("Disabling NPC Collection."); TTHSET["b"] = 1; end SLASH_TTHITEMDUMP1,SLASH_TTHITEMDUMP2 = '/tthitemdump','/psitemdump'; function SlashCmdList.TTHITEMDUMP(msg,editbox) qch("Dumping Items"); for iid=1,5000 do 
qct(iid); local _,qat,_,_,_,_,_,_,_,_,_ = GetItemInfo(iid); if(qat~=nil)then qdn(qat,iid); end end qch("Now that's a load off!"); end SLASH_TTHTIPDUMP1 = '/tthtipdump'; function SlashCmdList.TTHTIPDUMP(msg,editbox) local qas=1; local qat=5000; qch("Dumping Tooltips beginning at "..qas); for iid=qas,qat do DEFAULT_CHAT_FRAME:AddMessage("\124Hitem:"..iid..":0:0:0:0:0:0:0:0\124h[Item: "..iid.."]\124h\124r"); end end frame:SetScript("OnEvent", eventHandler); 